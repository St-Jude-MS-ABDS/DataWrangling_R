library(haven)
library(DBI)
library(odbc)
workpath <- "C:/Users/ychen3/Projects-Git/DataWrangling_R/"
setwd(workpath)
library(readxl)
readxl::read_xlsx("_dev/datawrangling_R_lecture5.xlsx")
workpath <- "C:/Users/ychen3/Projects-Git/DataWrangling_R/"
setwd(workpath)
workpath <- "C:/Users/ychen3/OneDrive - St. Jude Children's Research Hospital/GPM/DataWrangling_R//"
setwd(workpath)
readxl::read_xlsx("_dev/datawrangling_R_lecture5.xlsx")
dataxlsx <- readxl::read_xlsx("_dev/datawrangling_R_lecture5.xlsx")
View(dataxlsx)
dataxlsx <- readxl::read_xlsx("_dev/datawrangling_R_lecture5.xlsx", sheet = "Drug Unit")
View(dataxlsx)
?readxl::read_xlsx
dataxlsx <- readxl::read_xlsx("_dev/datawrangling_R_lecture5.xlsx", sheet = "Drug Unit", range = "D2:G72")
dataxlsx <- readxl::read_xlsx("_dev/datawrangling_R_lecture5.xlsx", sheet = "Drug Unit", range = "D2:G72")
View(dataxlsx)
apply(dataxlsx, 2, class)
sapply(dataxlsx, class)
colnames(dataxlsx)
datacsv <- read.csv("_dev/datawrangling_R_lecture5.csv")
datacsv <- read.csv("_dev/datawrangling_R_lecture5.csv", skip=2) # start reading from row #3
colnames(datacsv)
datacsv <- read.csv("_dev/datawrangling_R_lecture5.csv", skip=2, check.names = F) # use origin column names without checking by R
colnames(datacsv)
sapply(datacsv, class)
datacsv <- read.csv("_dev/datawrangling_R_lecture5.csv", skip=2, check.names = F, na.strings = ".") # cells with "." are missing
sapply(datacsv, class)
datacsv <- datacsv[,-1] # remove the first column
colnames(datacsv)
datasas <- haven::read_sas("_dev/datawrangling_R_lecture5.sas7bdat")
View(datasas)
colnames(datasas)
sapply(datasas, label)
sapply(datasas, labels)
labels(datasas)
View(datasas)
sapply(datasas, attr)
sapply(datasas, attr, "label")
save(list = c("datacsv","datasaa"), "ws20251008.RData")
save(list = c("datacsv","datasas"), "_dev/ws20251008.RData")
save(list = c("datacsv","datasas"), file="_dev/ws20251008.RData")
library(haven)
library(DBI)
library(odbc)
workpath <- "C:/Users/ychen3/OneDrive - St. Jude Children's Research Hospital/GPM/DataWrangling_R//"
setwd(workpath)
load("_dev/ws20251008.RData")
workpath <- "C:/Users/ychen3/OneDrive - St. Jude Children's Research Hospital/GPM/DataWrangling_R//"
setwd(workpath)
myenv <- new.env()
load("_dev/ws20251008.RData", envir = myenv)
View(myenv)
names(myenv)
datacsv <- myenv[["datacsv"]]
######
save.image(file = "_dev/ws_all.RData")
library(haven)
library(DBI)
library(odbc)
workpath <- "C:/Users/ychen3/OneDrive - St. Jude Children's Research Hospital/GPM/DataWrangling_R//"
setwd(workpath)
######
datacsv <- read.csv("_dev/datawrangling_R_lecture5.csv")
datacsv <- read.csv("_dev/datawrangling_R_lecture5.csv", skip=2) # start reading from row #3
colnames(datacsv)
datacsv <- read.csv("_dev/datawrangling_R_lecture5.csv", skip=2, check.names = F) # use origin column names without checking by R
colnames(datacsv)
sapply(datacsv, class)
datacsv <- read.csv("_dev/datawrangling_R_lecture5.csv", skip=2, check.names = F, na.strings = ".") # cells with "." are missing
sapply(datacsv, class)
datacsv <- datacsv[,-1] # remove the first column
colnames(datacsv)
######
datasas <- haven::read_sas("_dev/datawrangling_R_lecture5.sas7bdat")
colnames(datasas)
sapply(datasas, attr, "label")
######
save.image(file = "_dev/ws_all.RData")
save(list = c("datacsv","datasas"), file="_dev/ws.RData")
######
rm(list = ls())
workpath <- "C:/Users/ychen3/OneDrive - St. Jude Children's Research Hospital/GPM/DataWrangling_R//"
setwd(workpath)
load("_dev/ws.RData")
###### create a new env and load R data into it
rm(list = ls())
workpath <- "C:/Users/ychen3/OneDrive - St. Jude Children's Research Hospital/GPM/DataWrangling_R//"
setwd(workpath)
myenv <- new.env()
load("_dev/ws.RData", envir = myenv)
names(myenv)
datacsv <- myenv[["datacsv"]]
package_wishlist.V <- c(
"tidyverse",
"readxl",                 # import xls, xlsx
"openxlsx",               # import and format xlsx
"haven",                  # import sas, spss, strata
"DBI", "odbc", "RSQLite", # packages for SQL database connection
"httr",                   # package for HTTP API
"jsonlite",               # json parser in R
"googlesheets4",          # package that simplifies API to Google sheet
"WDI",                    # package that simplifies API to World Bank
"rentrez",                # package that simplifies API to Entrez databases (the r-cran version is suspending due to cran checks)
"VIM",                    # Visualizing and Imputing Missing Data
"mice"                    # Multivariate Imputation by Chained Equations. One of the most powerful tools for handling missing data
)
package_installed.DF <- as.data.frame(installed.packages()) # packages already installed
package_toinstall.V <- package_wishlist.V[!package_wishlist.V %in% package_installed.DF$Package]
# Add R code here to import datawrangling_R_lecture5.xlsx (sheet: Drug Unit). Use the readxl::read_xlsx() function and its arguments to import only columns D to G, and use row 2 as the column names.
library(readxl)
dataxlsx <- read_xlsx("datawrangling_R_lecture5.xlsx")
# Add R code here to check R data type for the imported data (Tip 1)
# Add R code here to return dimensions (number of rows and number of columns) of the imported data (Tip 2)
# Add R code here to return column names of the imported data (Tip 3)
# Please describe the differences between functions readxl::read_xlsx() and readxl::read_excel()
# [Your response]
?read.csv
library(haven)
library(DBI)
library(odbc)
workpath <- "C:/Users/ychen3/OneDrive - St. Jude Children's Research Hospital/GPM/DataWrangling_R//"
setwd(workpath)
###### Read CSV file
datacsv <- read.csv("_dev/datawrangling_R_lecture5.csv")
datacsv <- read.csv("_dev/datawrangling_R_lecture5.csv", skip=2) # start reading from row #3
colnames(datacsv)
###### load R data into global env
rm(list = ls())
workpath <- "C:/Users/ychen3/OneDrive - St. Jude Children's Research Hospital/GPM/DataWrangling_R//"
setwd(workpath)
load("_dev/ws.RData")
###### create a new env and load R data into it
rm(list = ls())
workpath <- "C:/Users/ychen3/OneDrive - St. Jude Children's Research Hospital/GPM/DataWrangling_R//"
setwd(workpath)
myenv <- new.env()
load("_dev/ws.RData", envir = myenv)
View(myenv)
names(myenv)
datacsv <- myenv[["datacsv"]]
data1 <- myenv[["datacsv"]]
workpath <- "C:/Users/ychen3/OneDrive - St. Jude Children's Research Hospital/GPM/DataWrangling_R//"
setwd(workpath)
datacsv <- read.csv("_dev/datawrangling_R_lecture5.csv")
View(datacsv)
datacsv <- read.csv("_dev/datawrangling_R_lecture5.csv", skip=2) # start reading from row #3
colnames(datacsv)
datacsv <- read.csv("_dev/datawrangling_R_lecture5.csv", skip=2, check.names = F) # use origin column names without checking by R
colnames(datacsv)
class(datacsv$sex)
sapply(datacsv, class)
datacsv <- read.csv("_dev/datawrangling_R_lecture5.csv", skip=2, check.names = F, na.strings = ".") # cells with "." are missing
sapply(datacsv, class)
datacsv <- datacsv[,-1] # remove the first column
datasas <- haven::read_sas("_dev/datawrangling_R_lecture5.sas7bdat")
colnames(datasas)
View(datasas)
sapply(datasas, attr, "label")
